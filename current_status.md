# English Widget 開発ステータス

*最終更新: 2025-12-07 10:45*

---

## 📜 これまでの経緯

### Phase 1: フラッシュカード基盤構築
- ネイティブが使う日常表現に特化したフラッシュカード学習ウィジェットを開発
- 200以上の単語・フレーズを収録（日常、句動詞、スラング、イディオム、ビジネス、発音注意）
- スペースド・リピティション（間隔反復）システムを実装
- デイリーチャレンジ機能（目標設定、ストリーク）を追加
- AI添削機能（Gemini API）で文章作成練習を実現

### Phase 2: 学習機能拡張（2025-12-07 完了）
高優先度タスク3つを**別ウィジェット**として実装:

#### 📔 DiaryWidget（英語日記）
- 毎日3文以上の英語日記
- AI添削・自然な表現提案
- 日記履歴の保存・閲覧
- ランダムプロンプト（10種類）
- 連続日数トラッキング

#### 💬 ConversationWidget（AI会話練習）
- 8つのシチュエーション対応:
  - 🍽️ レストラン、🛍️ ショッピング、🏨 ホテル、💼 面接練習
  - ✈️ 空港・旅行、☕ カフェ、🏥 病院、💬 雑談
- AIとのターンベース会話（Groq/Gemini切り替え可能）
- 音声入力対応（Web Speech Recognition）
- 音声読み上げ対応

#### ⚙️ AISettingsWidget（AI設定）✨ NEW
- Groq / Gemini の切り替え
- Groqモデル選択（Llama 3.1 70B, 8B, Mixtral等）
- 接続テスト機能
- フォールバック機能（片方が失敗したら自動で切り替え）

#### 🎧 ShadowingWidget（シャドーイング）
- 30の厳選フレーズ（初級10/中級10/上級10）
- 再生速度調整（0.6x / 0.8x / 1.0x）
- 発音練習（マイク入力）
- レベル別進捗トラッキング
- マスター済みバッジ表示

#### 🏆 AchievementsWidget（実績・ゲーミフィケーション）✨ NEW
- XP（経験値）システム
- レベルアップ機能（Lv.1〜20）
- 30種類以上のバッジ（コモン・レア・エピック・レジェンド）
- バッジ獲得時のアニメーション
- 全ウィジェットと連携（XP自動付与）

---

## ✅ 完了済み機能一覧

### FlashcardWidget（フラッシュカード）
- [x] フラッシュカード形式の単語学習
- [x] 200+ の単語・フレーズ収録
- [x] カテゴリ分け（日常、句動詞、スラング、イディオム、ビジネス、発音注意）
- [x] カスタム単語の追加・削除
- [x] 音声読み上げ（Web Speech API）
- [x] 例文表示
- [x] Lv.0〜5 の習熟度システム
- [x] 復習間隔の自動調整（即時→1h→4h→1日→3日→7日）
- [x] 「知ってる」「わからない」ボタンでレベル±1
- [x] マスター済み単語は出題されない
- [x] 1日の目標単語数（設定可能: 1/3/5/10/15/20）
- [x] プログレスバー表示
- [x] 連続日数（ストリーク）トラッキング
- [x] AI添削（Gemini API）
- [x] 統計画面（マスター数、学習中、復習待ち）
- [x] 進捗リセット確認ダイアログ
- [x] localStorageによるデータ永続化

### DiaryWidget（英語日記）✨ NEW
- [x] 毎日3文以上の英語日記
- [x] AI添削・自然な表現提案
- [x] 日記履歴の保存・閲覧
- [x] 連続日数（ストリーク）トラッキング
- [x] ランダムプロンプト表示（10種類）

### ConversationWidget（AI会話練習）✨ NEW
- [x] 8つのシチュエーション選択
- [x] AIとのロールプレイ形式会話
- [x] ターンベースの会話
- [x] 音声入力対応（Web Speech Recognition）
- [x] 音声読み上げ対応
- [x] 練習回数カウント

### ShadowingWidget（シャドーイング）✨ NEW
- [x] 30の厳選フレーズ（初級/中級/上級）
- [x] 再生速度調整（0.6x / 0.8x / 1.0x）
- [x] 発音練習（マイク入力）
- [x] 進捗トラッキング
- [x] マスター済みバッジ表示
- [x] 統計画面

---

## 🚧 次にやるべき残タスク

### 中優先度 ✅ 完了
1. **発音チェック強化** ✅
   - ShadowingWidgetに実装済み
   - Levenshtein距離を使ったスコア計算
   - スコア別フィードバック（完璧/いい感じ/もう少し/もう一度）

2. **復習リマインダー** ✅
   - FlashcardWidgetに実装済み
   - 復習待ち単語があるとき上部に通知表示
   - 「今すぐ復習」ボタンで即座に復習開始

3. **統計グラフ** ✅ NEW
   - LearningStatsWidget（📊 Stats）を新規作成
   - 週間学習アクティビティグラフ（recharts使用）
   - Flashcard/Diary/Conversation/Shadowingの統計統合
   - カテゴリ別習熟度の円グラフ
   - 週間ナビゲーション（過去の週を閲覧可能）

### 低優先度
4. **単語インポート/エクスポート**
   - JSON形式でカスタム単語をエクスポート
   - ファイルアップロードでインポート

5. **学習履歴ログ**
   - 日付ごとの学習記録
   - 何を学習したかの詳細ログ

6. **ダークモード対応**
   - 現状: ダッシュボード全体がダーク
   - 改善案: ライトモード切り替え対応

### アイデア（検討中）
- **発音比較機能**: ネイティブ音声と自分の発音を並べて比較
- **週間レポート**: 週ごとの学習サマリーをメール通知
- **ゲーミフィケーション**: バッジ、レベルアップ、ランキング
- **多言語対応**: 韓国語・中国語など他言語バージョン

---

## 📁 関連ファイル

| ファイル | 説明 |
|----------|------|
| `src/components/widgets/FlashcardWidget.tsx` | 🎯 フラッシュカードウィジェット（794行） |
| `src/components/widgets/DiaryWidget.tsx` | 📔 英語日記ウィジェット |
| `src/components/widgets/ConversationWidget.tsx` | 💬 AI会話練習ウィジェット |
| `src/components/widgets/ShadowingWidget.tsx` | 🎧 シャドーイングウィジェット |
| `src/components/widgets/LearningStatsWidget.tsx` | 📊 統合学習統計ウィジェット ✨ NEW |
| `src/components/Dashboard.tsx` | ダッシュボード本体（ウィジェット登録） |
| `src/app/api/chat/route.ts` | AI添削/会話API（Gemini 2.0 Flash） |
| `src/app/api/summarize/route.ts` | RSS要約API（Groq Llama 3.1） |

---

## 🔧 技術スタック

- **フロントエンド**: Next.js 16, React, TypeScript, Tailwind CSS
- **AI**: Google Gemini 2.0 Flash (添削/会話), Groq Llama 3.1 (RSS要約)
- **音声**: Web Speech API (読み上げ/認識)
- **データ保存**: localStorage
- **グリッドレイアウト**: react-grid-layout

---

## 🎯 使い方

1. http://localhost:3000 でダッシュボードを開く
2. 右上の **「+」ボタン** をクリック
3. **「Learning」カテゴリ** に4つのウィジェット:
   - 🎯 English（フラッシュカード）
   - 📔 Diary（日記）
   - 💬 Conversation（会話練習）
   - 🎧 Shadowing（シャドーイング）
   - 📊 Stats（統合統計）
4. 追加したいウィジェットをクリックしてダッシュボードに配置

---

## 📝 開発メモ

- 2025-12-07 10:20: 中優先度タスク完了（統計グラフ・発音チェック・復習リマインダー）
- 2025-12-07: 高優先度タスク3つ完了（日記・会話・シャドーイング）
- LearningStatsWidgetにrechartsを使用したグラフ表示を実装
- 各機能は**別ウィジェット**として実装（FlashcardWidgetが大きくなりすぎないように）
- 音声認識はChrome/Edgeで動作確認済み（Safari非対応）
- localStorage使用のため、ブラウザ間でデータ共有不可

